# [3015번_오아시스 재결합](https://www.acmicpc.net/problem/3015)

##  Category : 바킹독-스택

## 🎖정답과 내 풀이 비교

정말 오랜시간 고민했던 문제.

내 풀이는,

+ 맨 처음 수는 스택에 넣고, 

+ 입력된 수가 스택의 top보다 작다면, ans를 1 증가시키고 stack에 push한다. 

+ 입력된 수가 스택의 top보다 크거나 같다면

  현재 스택의 size만큼 ans를 증가시키고, 스택이 비어있지않고 스택의 top이 입력된 수보다 작거나 같아질때까지 스택을 pop한다. 그리고 입력된 수를 stack에 푸쉬한다.

였다. 처음엔 이렇게 코드를 짜놓고 반례가 없다고 생각했지만,

`5 5 5 2 2 5 `를 입력할 경우, 정답은 8이지만, 실제로는 9가 출력됐다.

그 이유는, 

만약 스택안에 `4 2 2` 이렇게 채워져있고, 현재 입력된 수가 `2` 라면, 2는 `4, 2, 2` 모두를 볼 수 있고, stack는 pop되면 안 되기 때문에, 나는 `ans += S.size();`라는 코드를 써서 구현했다. 하지만, 

스택에 `5 5 2`이렇게 채워져있고,  현재 입력된 수가 `2`라면, 2는 2와 5를 볼 수 있지만, 맨 밑의 5는 볼 수 없기 때문에 내 방식의 코드로는 정답을 출력하지 못했던 것이다. 

<br>

그래서 정답 코드에서는, 같은 수가 입력될 때 이를 모두 stack에 push 하는 것이 아니라, stack을 처음부터 `stack<pair<int, int>>`로 구현하여, 스택에 각 수와 그 수가 몇개 있는지 정보도 같이 저장하여, 만약 5가 2개 있다면 `{5, 2}`의 정보를 저장하게 했다. 

<br><br>

## 🎖 핵심 아이디어

+ 같은 숫자를 stack에 저장할 때, 여러번 push 하는것이 아니라, `<수, 그 수의 개수>`를 pair로 저장

+ 답을 저장하는 변수 ans는 왜 long long으로 선언해야 하나 ?

  => 

  만약에 500000개의 데이터가 모두 같은 숫자로 들어오면 어떻게 될까요?

  그렇게 되면 서로 바라볼 수 있는 경우의 수는 50만 C 2가 되고, 이는 인트형의 범위를 훌쩍 넘어섭니다. 

  따라서 **기본적으로 unsigned long long형 베이스나 long long형을 사용하셔서 결괏값을 표현하셔야 합니다.** 

<br><br>

-----

## 🎖 전체 코드

### My code

```c++
#define _CRT_SECURE_NO_WARNINGS

#include <iostream>
#include <cstdlib>
#include <cmath>
#include <algorithm>
#include <climits>
#include <cstring>
#include <string>
#include <vector>
#include <queue>
#include <deque>
#include <stack>
#include <map>
#include<iomanip>
#include<list>

using namespace std;

int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(0);
	cout.tie(0);

	int N;
	long long ans = 0;
	stack<int> S;

	cin >> N;
	long long num = 0;

	while (N--) {
		cin >> num;
		if (S.empty()) { // 맨 처음 수는 바로 스택에 넣어줌. 
			S.push(num);
			continue;
		}
		else if (num < S.top()) {
			ans++;
			S.push(num);
		}
		else {
			ans += S.size();

			while (!S.empty() && S.top() < num) {
				S.pop();
			}

			S.push(num);
		}
	}

	cout << ans;
	return 0;
}

// 2 4 1 2 2 5 1 
// 10 
```

<br>

<br>

### Solution code

```c++
#include <bits/stdc++.h>
using namespace std;
#define X first
#define Y second

int main(void) {
  ios::sync_with_stdio(0);
  cin.tie(0);
  int n;
  cin >> n;
  stack<pair<int, int>> S;
  long long ans = 0;
  while (n--) {
    int h;
    cin >> h;
    int cnt = 1;
    while (!S.empty() && S.top().X <= h) {
      ans += S.top().Y;
      if (S.top().X == h) cnt += S.top().Y;
      S.pop();
    }
    if (!S.empty()) ans++;
    S.push({h, cnt});
  }
  cout << ans;
}
```
