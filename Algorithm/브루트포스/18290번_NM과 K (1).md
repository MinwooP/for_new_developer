# [18290ë²ˆ_NMê³¼ K (1)](https://www.acmicpc.net/problem/18290)

##  Category : ë¸Œë£¨íŠ¸í¬ìŠ¤

-----

## ğŸ– ë‚´ í’€ì´

+ Nê³¼ M (1), (2)ë²ˆ ë¬¸ì œì²˜ëŸ¼ **ì¬ê·€**ë¥¼ ì´ìš©í•´ í’€ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ì„œ ê·¸ ë¬¸ì œì˜ ì¬ê·€ ì½”ë“œë¥¼ ì°¸ê³ í•´ ì§œë³´ì•˜ì§€ë§Œ, ì¬ê·€ë¥¼ ì•„ì§ ì™„ë²½í•˜ê²Œ ì´í•´í•˜ì§€ ëª»í•œ íƒ“ì¼ê¹Œ ì¤‘ê°„ì— ê¼¬ì˜€ë‹¤. 

<br>

<br>

-------

## ğŸ– Solution

### ì‹œê°„ ë³µì¡ë„ ê³„ì‚° 

+ 1<= N, M <=10,  1 <= K <= min(4, NxM)ì´ë¯€ë¡œ

  ì „ì²´ ê²½ìš°ì˜ ìˆ˜ëŠ” **NxM**ê°œ ì¤‘ì— **k**ë¥¼ ê³ ë¥´ëŠ” ê²ƒì´ë¯€ë¡œ

  **ìµœëŒ€** ì „ì²´ ê²½ìš°ì˜ ìˆ˜ëŠ” 100ê°œ ì¤‘ì— 4ê°œë¥¼ ê³ ë¥´ëŠ” ê²ƒì´ë¯€ë¡œ 100C4 = 3921225ê°œì´ë‹¤. ë°©ë²•ì˜ ê°œìˆ˜ê°€ ë§ì§€ ì•Šìœ¼ë‹ˆê¹Œ ì „ì²´ ë°©ë²•ì„ ë‹¤ ë§Œë“¤ì–´ë„ ë  ê²ƒì´ë‹¤. 

<br>

### í•µì‹¬ ì•„ì´ë””ì–´

<br>

### ì •ë‹µê³¼ ë‚´ í’€ì´ ë¹„êµ

+ ë‚˜ëŠ” ì¬ê·€í•¨ìˆ˜ì˜ í˜¸ì¶œë§Œì„ í†µí•´ ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ ë§Œë“¤ë ¤ê³  í•˜ë‹¤ë³´ë‹ˆ ê¼¬ì˜€ë˜ ê²ƒ ê°™ì€ë°, ì—¬ê¸°ì„œëŠ” **ì¬ê·€í•¨ìˆ˜ ë‚´ë¶€ì— for ë°˜ë³µë¬¸**ì„ êµ¬í˜„í•¨ìœ¼ë¡œì¨ xë¥¼ 0 ~ n-1ê¹Œì§€, yë¥¼ 0 ~ m-1ê¹Œì§€ íƒìƒ‰í•´ ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ ì˜ ì»¤ë²„í•´ì£¼ì—ˆë‹¤. 

+ ë˜í•œ, **ì„ íƒëœ ìˆ˜ì— ì¸ì ‘í•œ ìˆ˜ë“¤ì€ ì‚¬ìš©í•˜ì§€ ëª»í•œë‹¤ëŠ” ì¡°ê±´**ì„

  ë‚˜ëŠ”, ì„ íƒëœ ìˆ˜ì— ì¸ì ‘í•œ ìˆ˜ë“¤ì„ ë‹¤ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ ê°’ì„ ì„¤ì •í•´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í–ˆì§€ë§Œ

  ```c++
  int cannotuse[10][10] = { 0 }; // ê¸°ë³¸ê°’ falseì´ë¯€ë¡œ ë‹¤ ì‚¬ìš©ê°€ëŠ¥
  
  void selectrc(int r, int c) {
  	// r, cë¥¼ ì„ íƒí–ˆì„ ë•Œ ì¸ì ‘í•œ ìˆ˜ë“¤ì€ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ ë§Œë“œëŠ” í•¨ìˆ˜
  
  	// 1. [r, c] ì‚¬ìš© ë¶ˆê°€ëŠ¥
  	cannotuse[r][c]++;
  
  	// 2. ìœ„ìª½ [r-1, c] ì‚¬ìš© ë¶ˆê°€ëŠ¥
  	if (r > 0)
  		cannotuse[r - 1][c]++;
  
  	// 3. ì•„ë˜ìª½ ì‚¬ìš© ë¶ˆê°€ëŠ¥
  	if (r + 1 < m)
  		cannotuse[r + 1][c]++;
  
  	// 4. ì™¼ìª½
  	if (c > 0)
  		cannotuse[r][c - 1]++;
  
  	// 5. ì˜¤ë¥¸ìª½
  	if (c + 1 < n)
  		cannotuse[r][c + 1]++;
  
  }
  
  ```

  =>

  ì†”ë£¨ì…˜ì—ì„œëŠ”, ì´ë ‡ê²Œ ì¸ì ‘í•œ ìˆ˜ë“¤ì„ ë‹¤ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ ê°’ì„ ì„¤ì •í•´ì£¼ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, **ì–´ë–¤ ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ íŒë‹¨í•  ë•Œ, ê·¸ ìˆ˜ì˜ ìƒ, í•˜, ì¢Œ, ìš°ì— ì´ë¯¸ ì„ íƒëœ ìˆ˜ê°€ ìˆëŠ”ì§€ë§Œì„ ê²€ì‚¬**í•´ì£¼ì—ˆë‹¤.

  ì¦‰, ë°°ì—´ì—ì„œ ì´ë¯¸ ì„ íƒëœ ìˆ˜ë§Œ trueì´ê³ , ë‚˜ë¨¸ì§€ ê°’ì€ ë‹¤ falseì¸ë° ì§€ê¸ˆ ì„ íƒí•˜ë ¤ê³  í•˜ëŠ” ìˆ˜ì˜ ìƒ, í•˜, ì¢Œ, ìš°ì— trueê°€ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ ì„ íƒë¶ˆê°€, í•˜ë‚˜ë„ ì—†ìœ¼ë©´ ì„ íƒê°€ëŠ¥

  ```c++
  for (int i = 0; i < 4; i++) {	// ì•„ë˜ìª½, ìœ„ìª½, ì˜¤ë¥¸ìª½, ì™¼ìª½
  	int nx = x + dx[i];
  	int ny = y + dy[i];
  
  	if (0 <= nx && nx < n && 0 <= ny && ny < m) { 
  		if (c[nx][ny]) 
  			ok = false;
  	}
  }
  ```



### êµ¬í˜„ìŠ¤í‚¬

+ ì €ë²ˆ x, y ìœ„ì¹˜ë¶€í„° forë¬¸ì„ ì‹œì‘

  ```c++
  for (int x = px; x < n; x++) {
  	for (int y = (x == px ? py : 0); y < m; y++) {
          ~
      }
  }
  ```

  => êµ‰ì¥íˆ ì„¼ìŠ¤ìˆê²Œ ì˜ ì§  ì½”ë“œì¸ ê²ƒ ê°™ë‹¤. 



<br>

### ì •ë‹µì½”ë“œì˜ ì‹œê°„ë³µì¡ë„ ê³„ì‚°

+ kê°€ ìµœëŒ€ 4ì´ë¯€ë¡œ ì¬ê·€í•¨ìˆ˜ëŠ” ìµœëŒ€ 4ë²ˆ í˜¸ì¶œ, ê°ê°ì˜ í˜¸ì¶œë§ˆë‹¤ N*M ë²ˆì˜ ë°˜ë³µë¬¸ì„ ì‚¬ìš©í•˜ê³  ìˆìŒ. 

  ì´, (NM)^4 ë²ˆ ì´ë¯€ë¡œ ì‹œê°„ë³µì¡ë„ëŠ” O((NM)^k) ì´ë‹¤. 

+ ì´ ë°©ë²•ì€ ì„ íƒí•œ ì¹¸ì´ ê°™ì€ë°, ì„ íƒí•œ ìˆœì„œê°€ ë‹¤ë¥¸ ë°©ë²•ì„ ì—¬ëŸ¬ ë²ˆ ê³„ì‚°í•˜ê²Œ ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ (1,2), (2,1), (3,4)ë¥¼ ì„ íƒí•œ í›„ì— ë‹¤ì‹œ (2,1), (1,2), (3,4)ë¥¼ ë˜ ì„ íƒí•  ìˆ˜ ìˆë‹¤. 

  ë”°ë¼ì„œ, ì‹œê°„ ë³µì¡ë„ë¥¼ ì¤„ì´ê¸° ìœ„í•œ ë‘ë²ˆì§¸ ë°©ë²•

  => **forë¬¸ì˜ ì‹œì‘ ìœ„ì¹˜ë¥¼ ì €ë²ˆ x,y ìœ„ì¹˜ë¶€í„°**ë¡œ ë³€ê²½í•´ì£¼ê¸° ìœ„í•´ í•¨ìˆ˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ 

  ```c++
  void go(int px, int py, int cnt, int sum) {
  	if (cnt == k) {
  		if (ans < sum) ans = sum;
  		return;
  	}
  
  	for (int x = px; x < n; x++) {
  		for (int y = (x == px ? py : 0); y < m; y++) {
  
  			if (c[x][y]) continue;
  			bool ok = true;
  
  			for (int i = 0; i < 4; i++) {
  				int nx = x + dx[i];
  				int ny = y + dy[i];
  
  				if (0 <= nx && nx < n && 0 <= ny && ny < m) {
  					if (c[nx][ny]) ok = false;
  				}
  			}
  
  			if (ok) {
  				c[x][y] = true;
  				go(x, y, cnt + 1, sum + a[x][y]);
  				c[x][y] = false;
  			}
  		}
  	}
  }
  ```

  

































<br>

<br>

-----

## ğŸ– ì „ì²´ ì½”ë“œ

### ë‚´ ì½”ë“œ

```c++
#include <iostream>
using namespace std;


int k;
int m, n;
int ans = 0;
int temp = 0;

int table[10][10];
int cannotuse[10][10] = { 0 }; // ê¸°ë³¸ê°’ falseì´ë¯€ë¡œ ë‹¤ ì‚¬ìš©ê°€ëŠ¥


void selectrc(int r, int c) {
	// r, cë¥¼ ì„ íƒí–ˆì„ ë•Œ ì¸ì ‘í•œ ìˆ˜ë“¤ì€ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ ë§Œë“œëŠ” í•¨ìˆ˜

	// 1. [r, c] ì‚¬ìš© ë¶ˆê°€ëŠ¥
	cannotuse[r][c]++;

	// 2. ìœ„ìª½ [r-1, c] ì‚¬ìš© ë¶ˆê°€ëŠ¥
	if (r > 0)
		cannotuse[r - 1][c]++;

	// 3. ì•„ë˜ìª½ ì‚¬ìš© ë¶ˆê°€ëŠ¥
	if (r + 1 < m)
		cannotuse[r + 1][c]++;

	// 4. ì™¼ìª½
	if (c > 0)
		cannotuse[r][c - 1]++;

	// 5. ì˜¤ë¥¸ìª½
	if (c + 1 < n)
		cannotuse[r][c + 1]++;

}

void releaserc(int r, int c) {
	// r, cë¥¼ ë†“ì•„ì¤„ ë•Œ ê·¸ ì¸ì ‘í•œ ìˆ˜ë„ ì´ì œ ì‚¬ìš©ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” í•¨ìˆ˜
	
	// 1. [r, c] ì‚¬ìš©ê°€ëŠ¥
	cannotuse[r][c]--;

	// 2. ìœ„ìª½ [r-1, c] ì‚¬ìš©ê°€ëŠ¥
	if (r > 0)
		cannotuse[r - 1][c]--;

	// 3. ì•„ë˜ìª½ ì‚¬ìš©ê°€ëŠ¥
	if (r + 1 < m)
		cannotuse[r + 1][c]--;

	// 4. ì™¼ìª½
	if (c > 0)
		cannotuse[r][c - 1]--;

	// 5. ì˜¤ë¥¸ìª½
	if (c + 1 < n)
		cannotuse[r][c + 1]--;

}




void go(int i, int j, int selected) { // go(0, 0, 0)

	if (selected == k) {// ì´ë¯¸ kê°œ ì„ íƒ í›„  go(k)ì„ í˜¸ì¶œí–ˆìœ¼ë¯€ë¡œ 
		if (temp > ans)
			ans = temp;// ê¸°ì¡´ ìµœëŒ“ê°’ê³¼ ë¹„êµí•´ì„œ ë” í¬ë©´ ì—…ë°ì´íŠ¸
		return;
	}

	if (i > n - 1 || j > m - 1)
		return;

	// í•´ë‹¹ i, jë¥¼ ì„ íƒí•  ë•Œ
	if (cannotuse[i][j] == 0) { // ì‚¬ìš©í•  ìˆ˜ ìˆì„ ë•Œ, ì¦‰ ì´ë¯¸ ì„ íƒí•œ ìˆ˜ì— ì¸ì ‘í•˜ì§€ ì•Šì„ ë•Œ
		temp = temp + table[i][j];
		selectrc(i, j); // ì´ì œ [i,j]ì™€ ì´ì— ê·¼ì ‘í•œ ìˆ˜ë“¤ì€ ì ì‹œ ì‚¬ìš© ëª»í•¨

		if (j == m - 1)// ì œì¼ ì˜¤ë¥¸ìª½ì¼ ë•Œ 
			go(i + 1, 0, selected + 1);
		else
			go(i, j + 1, selected + 1);
	}
	else {  // 1ë²ˆ 
		// í˜„ì¬ i, j  ì„ íƒ í•˜ì§€ ì•Šê³  ë‹¤ìŒ ì¬ê·€ í˜¸ì¶œ
		if (j == m - 1)// ì œì¼ ì˜¤ë¥¸ìª½ì¼ ë•Œ 
			go(i + 1, 0, selected);
		else
			go(i, j + 1, selected);
		return;
	}

	// release
	temp = temp - table[i][j];
	releaserc(i, j);

	// 2ë²ˆ
	// í˜„ì¬ i, j  ì„ íƒ í•˜ì§€ ì•Šê³  ë‹¤ìŒ ì¬ê·€ í˜¸ì¶œ
	if (j == m - 1)// ì œì¼ ì˜¤ë¥¸ìª½ì¼ ë•Œ 
		go(i + 1, 0, selected);
	else
		go(i, j + 1, selected);

	return;
/*

	// í˜„ì¬ i, j  ì„ íƒ í›„ ë‹¤ìŒ ì¬ê·€ í˜¸ì¶œ
	if (j == m - 1)// ì œì¼ ì˜¤ë¥¸ìª½ì¼ ë•Œ 
		go(i + 1, 0, selected + 1);
	else
		go(i, j + 1, selected + 1);

	// í˜„ì¬ i, j  ì„ íƒ í•˜ì§€ ì•Šê³  ë‹¤ìŒ ì¬ê·€ í˜¸ì¶œ
	if (j == m - 1)// ì œì¼ ì˜¤ë¥¸ìª½ì¼ ë•Œ 
		go(i + 1, 0, selected);
	else
		go(i, j + 1, selected );

*/


	// ì–¸ì œ release í•´ì¤˜ì•¼ í• ê¹Œ 
	// í•´ë‹¹ i, jë¥¼ ì„ íƒì•ˆí•  ë•Œ
	// ì˜¤ë¥¸ìª½, ì•„ë˜ìª½ìœ¼ë¡œ ì„ í˜•ì ìœ¼ë¡œ íƒìƒ‰í•˜ë©´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”(cannnotuse == falseì¸)ìˆ˜ë¥¼ ì„ íƒ
	// 


	// ì˜¤ë¥¸ìª½ ëì¼ ë•Œ, ì¦‰, j = m-1ì¼ ë•Œ ê³ ë ¤
	// temp ì´ˆê¸°í™”
}


int main() {
	cin >> n >> m >> k;; // 4 , 2
	
	for (int i = 0; i < n; i++) {
		for (int j = 0; j < m; j++) {
			cin >> table[i][j];
		}
	}

	go(0, 0, 0);
	
	cout << ans;

	return 0;
}
```

í•¨ìˆ˜ í˜¸ì¶œ ê³¼ì •

+ go(0, 0, 0)           // temp = 1,  select(0, 0)

  + go(0, 1, 1)      // **1ë²ˆ**ì„  í˜¸ì¶œ

    + go(0, 2, 1)   // temp = 1 + 3 = 4; ì…€ë ‰íŠ¸(0, 2)   // **1ë²ˆ**ì—ì„œ í˜¸ì¶œ

      + go(1, 0, 2)   // ans = 4; return;

    + go(0, 2, 1)   // temp = 1  ; ë¦´ë¦¬ì¦ˆ(0, 2)  **2ë²ˆ**ì„ í˜¸ì¶œ

      + go(1, 0, 1)   // **2ë²ˆ**ì—ì„œ í˜¸ì¶œ

        + go(1, 1, 1)   // temp = 1+ 5 = 6;  ì…€ë ‰íŠ¸

          + go(1, 2, 2)   // ans = 6; return; 

        + go(1, 1, 1)   // temp = 1;  ë¦´ë¦¬ì¦ˆ

          + go(1, 2, 1)  // temp = 1 + 6 = 7; ì…€ë ‰íŠ¸

            + go(2, 0, 2)  // ans = 7; return;

          + go(1, 2, 1)  // temp = 1; ë¦´ë¦¬ì¦ˆ 

            + go(2, 0, 1)  // temp = 1 + 7 = ;


<br>

<br>

### Solution code ver1

```c++
#include <iostream>
using namespace std;
int a[10][10];
bool c[10][10]; // trueì´ë©´ ì‚¬ìš© ë¶ˆê°€ëŠ¥


int n, m, k;
int ans = -2147483647;
int dx[] = { 0,0,1,-1 }; // ì˜¤ë¥¸ìª½, ì™¼ìª½, ì•„ë˜, ìœ„
int dy[] = { 1,-1,0,0 };


void go(int cnt, int sum) {  // cnt : ì„ íƒí•œ ìˆ˜ì˜ ê°œìˆ˜, sum : ì•„ì§ê¹Œì§€ ì„ íƒí•œ ìˆ˜ë“¤ì˜ í•©

	if (cnt == k) { // ì´ë¯¸ 0 ~ k-1 kê°œ ì„ íƒí–ˆìœ¼ë¯€ë¡œ ì´ì œ ì¶œë ¥
		if (ans < sum) ans = sum;
		return;
	}

	for (int x = 0; x < n; x++) {   // [0, 0] ~ [n-1, m-1]
		for (int y = 0; y < m; y++) {

			// í˜„ì¬ [x][j]ê°€ ì‚¬ìš©ì¤‘ì´ë©´ 
			if (c[x][y]) 
				continue;

			bool ok = true;

			// [i][j] ì˜¤ë¥¸, ì™¼, ì•„ë˜, ìœ„ ì¤‘ í•˜ë‚˜ë¼ë„ ì‚¬ìš©ì¤‘ì´ë©´ 
			for (int i = 0; i < 4; i++) {	// ì•„ë˜ìª½, ìœ„ìª½, ì˜¤ë¥¸ìª½, ì™¼ìª½
				int nx = x + dx[i];
				int ny = y + dy[i];

				if (0 <= nx && nx < n && 0 <= ny && ny < m) { // ìœ íš¨í•œ ìœ„ì¹˜ì•ˆì— ìˆì„ ë•Œ, 
					if (c[nx][ny]) // í•˜ë‚˜ë¼ë„ ì‚¬ìš©ì¤‘ì´ë©´, ì¦‰, trueì´ë©´ ok = falseë¥¼ í†µí•´ í˜„ì¬ [x][y]ì—ì„œ í˜¸ì¶œ ëª»í•˜ë„ë¡
						ok = false;
				}
			}

			if (ok) {
				c[x][y] = true;
				go(cnt + 1, sum + a[x][y]);
				c[x][y] = false;
			}
		}
	}
}




int main() {
	cin >> n >> m >> k;
	for (int i = 0; i < n; i++) {
		for (int j = 0; j < m; j++) {
			cin >> a[i][j];
		}
	}
	go(0, 0);
	cout << ans << '\n';
	return 0;
}
```

<br>

<br>

### Solution code ver2

```c++
#include <iostream>
using namespace std;

int a[10][10];
bool c[10][10];
int n, m, k;
int ans = -2147483647;
int dx[] = { 0,0,1,-1 };
int dy[] = { 1,-1,0,0 };


void go(int px, int py, int cnt, int sum) {
	if (cnt == k) {
		if (ans < sum) ans = sum;
		return;
	}

	for (int x = px; x < n; x++) {
		for (int y = (x == px ? py : 0); y < m; y++) {

			if (c[x][y]) continue;
			bool ok = true;

			for (int i = 0; i < 4; i++) {
				int nx = x + dx[i];
				int ny = y + dy[i];

				if (0 <= nx && nx < n && 0 <= ny && ny < m) {
					if (c[nx][ny]) ok = false;
				}
			}

			if (ok) {
				c[x][y] = true;
				go(x, y, cnt + 1, sum + a[x][y]);
				c[x][y] = false;
			}
		}
	}
}

int main() {
	cin >> n >> m >> k;
	for (int i = 0; i < n; i++) {
		for (int j = 0; j < m; j++) {
			cin >> a[i][j];
		}
	}
	go(0, 0, 0, 0);
	cout << ans << '\n';
	return 0;
}
```

